Based on "Real-Time Fluid Dynamics for Games" paper from Jos Stam (jstam@aw.sgi.com).